'use strict';(function(){function m(a,b,d,c,e,f){e=e||[];Array.isArray(e)||(e=[e]);if(2<b.length)throw console.log({m:"UTIL.decorateElement: too many ids",spec,attrs:c,names:b}),Error("UTIL.decorateElement: too many ids");for(1<b.length&&a.setAttribute("id",b[1]);0<d.length;)a.classList.add(d.shift());for(c&&Object.entries(c).forEach(([b,d])=>{"style"===b?Object.entries(d).forEach(([b,d])=>{a.style[b]=d}):"dataset"===b?Object.entries(d).forEach(([b,d])=>{a.dataset[b]=d}):a.setAttribute(b,d)});0<e.length;)if(b=
e.shift(),"string"==typeof b)for(d=document.createElement("div"),d.innerHTML=b;d.firstChild;)a.appendChild(d.firstChild);else a.appendChild(b);if(f){e=f(a);if(e instanceof HTMLElement)return e;console.error(Error("UTIL.decorateElement decorator function did not return a DOM node"))}return a}NgChm.markFile();const c=NgChm.createNS("NgChm.UTIL"),q=NgChm.importNS("NgChm.CFG");c.getURLParameter=function(a){return decodeURIComponent(((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)")).exec(location.search)||
[,""])[1].replace(/\+/g,"%20"))||""};c.mapId=c.getURLParameter("map");c.mapNameRef=c.getURLParameter("name");c.capitalize=function(a){return a.substr(0,1).toUpperCase()+a.substr(1)};(function(){c.passiveCompat=function(){var a=!1;const b=function(){};try{var d=Object.defineProperty({},"passive",{get(){a=!0}});window.addEventListener("test",b,d);window.removeEventListener("test",b,d)}catch(g){}return a}()?a=>a:a=>!!a.capture})();{const a=new Map;c.setKeyData=function(b,d){a.set(b,d)};c.getKeyData=
function(b){return a.get(b)}}c.setKeyData("web-builder-url",q.builder_url);c.addScript=function(a,b){const d=document.getElementsByTagName("head")[0];a=c.newElement("script",{type:"text/javascript",src:a});d.appendChild(a);a.onload=b;a.onreadystatechange=function(){"complete"==this.readyState&&b()}};c.addScripts=function(a,b){c.addScript(a[0],()=>{1===a.length?b():c.addScripts(a.slice(1),b)})};c.setElementPositionSize=function(a,b,d){a&&a.style||console.error("setElementPositionSize on non-element",
a);b.left&&(a.style.left=b.left+"px");b.top&&(a.style.top=b.top+"px");a.style.width=b.width+"px";a.style.height=b.height+"px";d||"CANVAS"!==a.tagName||(a.width=Math.round(b.width),a.height=Math.round(b.height))};c.newTxt=function(a){return document.createTextNode(a)};c.newSvgButton=function(a,b,d){a=a.split(".");const g=a.shift().split("#"),e=g[0].split("!"),f=c.newElement("BUTTON");f.innerHTML=e.map(a=>'<SVG width="1em" height="1em"><USE href="icons.svg#'+a+'"/></SVG>').join("");return m(f,g,a,b,
[],d)};c.newSvgMenuItem=function(a,b,d){a=a.split(".");const g=a.shift().split("#"),e=g[0].split("!"),f=c.newElement("DIV.menuSvg");f.innerHTML=e.map(a=>'<SVG width="1em" height="1em"><USE href="icons.svg#'+a+'"/></SVG>').join("");return m(f,g,a,b,[],d)};c.newElement=function(a,b,d,c){a=a.split(".");const g=a.shift().split("#"),f=document.createElement(g[0]);return m(f,g,a,b,d,c)};c.newFragment=function(a){const b=document.createDocumentFragment();a.forEach(a=>{b.appendChild(a)});return b};c.newButton=
function(a,b,d){a=c.newElement("SPAN.button",{},[c.newTxt(a)]);for(const b of Object.entries(d))a.addEventListener(b[0],b[1]);return a};c.showTab=function(a){const b=document.getElementById(a);b||console.error("No tab button identified by buttonId:",{buttonId:a});(function(a){[...a.children].forEach(a=>{const b=document.getElementById(a.dataset.forTab);b||console.error("No tab identified by button:",{btn:a});b.classList.add("hide");a.classList.remove("selected")})})(b.parentElement);const d=b.dataset.forTab&&
document.getElementById(b.dataset.forTab);d||console.error("No tab identified by buttonId:",{buttonId:a});d.classList.remove("hide");b.classList.add("selected")};c.toTitleCase=function(a){return a.toLowerCase().replace(/_/g," ").replace(/\b([a-z\u00C0-\u00ff])/g,function(a,d){return d.toUpperCase()}).replace(/(\s(?:de|a|o|e|da|do|em|ou|[\u00C0-\u00ff]))\b/ig,function(a,d){return d.toLowerCase()})};c.getStyle=function(a,b){if(a.currentStyle)var d=a.currentStyle[b];else window.getComputedStyle&&(d=
document.defaultView.getComputedStyle(a,null).getPropertyValue(b));return d};c.returnToHome=function(){var a=c.getURLParameter("collectionHome");""!==a&&window.open(a,"_self")};c.reverseObject=function(a){var b=[],d=[],c;for(c in a)b.push(c);for(a=b.length-1;0<=a;a--)d[b[a]]=[];return d};c.isScreenZoomed=function(){var a=0;.89>window.devicePixelRatio?a=-1:1.375<window.devicePixelRatio&&(a=1);return a};c.getBrowserType=function(){var a="unknown";if(-1!=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR")))a=
"Opera";else if(-1!=navigator.userAgent.indexOf("Chrome"))a="Chrome";else if(-1!=navigator.userAgent.indexOf("Safari"))a="Safari";else if(-1!=navigator.userAgent.indexOf("Firefox"))a="Firefox";else if(-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode)a="IE";return a};c.minLabelSize=5;c.showSummaryPane=!0;c.showDetailPane=!0;c.blendTwoColors=function(a,b){b=b||"#ffffff";a=(a||"#000000").substring(1);b=b.substring(1);a=[parseInt(a[0]+a[1],16),parseInt(a[2]+a[3],16),parseInt(a[4]+a[5],
16)];b=[parseInt(b[0]+b[1],16),parseInt(b[2]+b[3],16),parseInt(b[4]+b[5],16)];a=[.5*a[0]+.5*b[0],.5*a[1]+.5*b[1],.5*a[2]+.5*b[2]];return a="#"+c.intToHex(a[0])+c.intToHex(a[1])+c.intToHex(a[2])};c.intToHex=function(a){a=Math.round(a).toString(16);1==a.length&&(a="0"+a);return a};c.convertToArray=function(a){var b=[];b.push(a);return b};c.isBuilderView=!1;c.containerElement=document.getElementById("ngChmContainer");c.removeElementsByClass=function(a){for(a=document.getElementsByClassName(a);0<a.length;)a[0].parentNode.removeChild(a[0])};
c.shadeColor=function(a,b){var d=b/100;b=parseInt(a.slice(1),16);a=0>d?0:255;d=0>d?-1*d:d;var c=b>>16,e=b>>8&255;b&=255;return"#"+(16777216+65536*(Math.round((a-c)*d)+c)+256*(Math.round((a-e)*d)+e)+(Math.round((a-b)*d)+b)).toString(16).slice(1)};c.imageCanvas=function(a){let b=document.createElement("canvas");const d=b.getContext("2d");b.width=a.width;b.height=a.height;d.drawImage(a,0,0);return b};c.isNaN=function(a){let b;b=isNaN(a);""===a.trim()&&(b=!0);return b};c.isValidURL=function(a){try{new URL(a)}catch(b){return!1}return!0};
c.dragElement=function(a){function b(b){b=b||window.event;b.preventDefault();const e=a.getBoundingClientRect();f=b.clientX-e.x;h=b.clientY-e.y;l=-e.width/2;p=window.innerWidth-e.width/2;b=n.getBoundingClientRect();k=window.innerHeight-b.height;document.onmouseup=c;document.onmousemove=d}function d(b){b=b||window.event;b.preventDefault();const d=b.clientY-h;a.style.left=Math.min(p,Math.max(l,b.clientX-f))+"px";a.style.top=Math.min(k,Math.max(-2,d))+"px";b=document.getElementById("content").clientHeight;
a.style.height="";a.offsetHeight>e+b&&(a.style.height=e+b+"px")}function c(){document.onmouseup=null;document.onmousemove=null}const e=document.getElementById("mdaServiceHeader").clientHeight;let f=0,h=0,k=0,l=0,p=0;const n=document.getElementById(a.id+"Hdr")||a.querySelector(".msgBoxHdr");n&&(n.onmousedown=b)};c.roundUpDown=function(a,b){var d=a,c=a%10;5===b?d=5>c&&3<=c||5<c&&7<=c?5*Math.ceil(a/5):5*Math.floor(a/5):10===b&&(d=5<=c?10*Math.ceil(a/10):10*Math.floor(a/10));return d};c.createCheckBoxDropDown=
function(a,b,d,g,e){function f(a){c.toggleCheckBox(a,a.target)}b=document.getElementById(b);var h=document.getElementById(a);a=[];for(let b=0;b<g.length;b++)a.push(g[b]);a.sort((a,b)=>a.localeCompare(b,void 0,{sensitivity:"base"}));h.innerHTML="<select><option>"+d+"</option></select><div id='overSelect' class='dropDownOverSelect'></div>";d="";for(h=0;h<a.length;h++)d=d+"<label for='"+a[h]+"' ><input type='checkBox' class='srchCovCheckBox' value='"+a[h]+"' name='"+a[h]+"'>"+a[h]+"</input></label>";
b.style.height=20<g.length?e:18*(g.length+1)+"px";b.innerHTML=d+"<label for='Missing'><input type='checkBox' class='srchCovCheckBox' value='missing' name='missing'>Missing</input></label>";b.querySelectorAll("label").forEach(a=>{a.onclick=f})};c.clearCheckBoxDropdown=function(a){document.getElementById(a).innerHTML=""};c.resetCheckBoxDropdown=function(a){a=document.getElementsByClassName(a);for(var b=0;b<a.length;b++)a[b].checked=!1};c.toggleCheckBox=function(a,b){"LABEL"===a.target.nodeName&&(b.children[0].checked=
!b.children[0].checked)};c.showCheckBoxDropDown=function(a){a=document.getElementById(a);a.style.display="none"===a.style.display?"block":"none"};c.closeCheckBoxDropdown=function(a,b){null!==document.getElementById(b).offsetParent&&document.getElementById(a).click()};c.keepElementInViewport=function(a){a=document.getElementById(a);if(null!==a){const b=a.getBoundingClientRect();b.bottom<window.innerHeight&&a.style.height&&(a.style.height="");b.bottom>window.innerHeight&&(a.style.height=window.innerHeight-
b.top+"px");b.right>window.innerWidth&&(a.style.left=window.innerWidth-b.width+"px");0>b.top&&(a.style.top="0px");0>b.left&&(a.style.left="0px")}};c.embedLoaded=!1;c.embedThumbWidth="150px";c.embedThumbHeight="150px";c.defaultNgchmWidget="ngchmWidget-min.js";c.setNgchmWidget=function(a){c.defaultNgchmWidget=a};c.embedExpandableMap=function(a){if(void 0!==a.ngchm){void 0===a.divId&&(a.divId="NGCHM");void 0===a.thumbnail&&(a.thumbnail=a.ngchm.replace(/\.ngchm$/,".png"));void 0===a.thumbnailWidth&&(a.thumbnailWidth=
"150px");void 0===a.thumbnailHeight&&(a.thumbnailHeight=a.thumbnailWidth);void 0===a.ngchmWidget&&(a.ngchmWidget=c.defaultNgchmWidget);var b=void 0===a.displayWidth?"100":a.displayWidth.substring(0,a.displayWidth.length-1),d=void 0===a.customJS?"":a.customJS,g=b;70>=b&&(g=70);c.embedThumbWidth=a.thumbnailHeight;var e=document.getElementById(a.divId),f=document.createElement("iframe");f.id=a.divId+"_iframe";f.scrolling="no";f.style="height:"+a.thumbnailHeight+"; width:100%; border-style:none; ";f.sandbox=
"allow-scripts allow-same-origin allow-popups allow-forms allow-modals allow-downloads";f.className="ngchmThumbnail";e.appendChild(f);e=f.contentWindow.document;e.open();e.write("<!DOCTYPE html><HTML><BODY style='margin:0px;width:100vw;height: 100vh;display: flex;flex-direction: column;'><div id='NGCHMEmbedWrapper' class='NGCHMEmbedWrapper' style='height: "+a.thumbnailHeight+"; width: "+a.thumbnailWidth+"'><img img id='NGCHMEmbedButton' src='"+a.thumbnail+"' alt='Show Heat Map' onclick='NgChm.API.showEmbed(this,\""+
b+'","'+g+'","'+d+"\");' /><div class='NGCHMEmbedOverlay' onclick='NgChm.UTIL.showEmbed(this,\""+b+'","'+g+'","'+d+"\");' ><div id='NGCHMEmbedOverText'>Expand<br>Map</div></div></div><div id='NGCHMEmbedCollapse' style='display: none;width: 100px; height: 20px;'><div class='buttonGroup'><button id='NGCHMEmbedButton' onclick='NgChm.API.hideEmbed();'><span class='button'>Collapse Map</span></button></div></div><br/><div id='NGCHMEmbed' style='display: none; background-color: white; height: 100%; width: 98%; border: 2px solid gray; padding: 5px;'></div><script src='"+
a.ngchmWidget+"'>\x3c/script><script type='text/Javascript'>NgChm.API.embedCHM('"+a.ngchm+"');\x3c/script></BODY></HTML><br><br>");e.close()}};c.defaultNgchmWidget="ngchmWidget-min.js";c.b64toBlob=function(a){a=atob(a);let b=[];for(var d=0;d<a.length;d+=512){const e=a.slice(d,d+512);let f=Array(e.length);for(var c=0;c<e.length;c++)f[c]=e.charCodeAt(c);c=new Uint8Array(f);b.push(c)}return new Blob(b)};c.getClickType=function(a){var b=0;a=a||window.event;a.which||"undefined"===typeof a.button||(a.which=
a.button&1?1:a.button&2?3:a.button&4?2:0);switch(a.which){case 3:b=1}a.ctrlKey&&(b=1);return b};c.getCursorPosition=function(a){if(a.touches)if(0<a.touches.length){var b=a.target.getBoundingClientRect();var c=Math.round(a.targetTouches[0].pageX-b.left);a=Math.round(a.targetTouches[0].pageY-b.top)}else b=a.target.getBoundingClientRect(),c=Math.round(a.changedTouches[0].pageX-b.left),a=Math.round(a.changedTouches[0].pageY-b.top);else c=a.offsetX,a=a.offsetY;return{x:c,y:a}};c.hexToComplimentary=function(a){var b=
"rgb("+(a=a.replace("#","")).match(new RegExp("(.{"+a.length/3+"})","g")).map(function(b){return parseInt(a.length%2?b+b:b,16)}).join(",")+")";b=b.replace(/[^\d,]/g,"").split(",");var c=b[0],g=b[1],e=b[2];c/=255;g/=255;e/=255;var f=Math.max(c,g,e),h=Math.min(c,g,e);b=(f+h)/2;if(f==h)var k=h=0;else{var l=f-h;h=.5<b?l/(2-f-h):l/(f+h);f==c&&g>=e?k=1.0472*(g-e)/l:f==c&&g<e?k=1.0472*(g-e)/l+6.2832:f==g?k=1.0472*(e-c)/l+2.0944:f==e&&(k=1.0472*(c-g)/l+4.1888)}k=k/6.2832*360+45;360<k&&(k-=360);k/=360;0===
h?c=g=e=b:(e=function(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a},f=.5>b?b*(1+h):b+h-b*h,b=2*b-f,c=e(b,f,k+1/3),g=e(b,f,k),e=e(b,f,k-1/3));c=Math.round(255*c);g=Math.round(255*g);e=Math.round(255*e);return"#"+(16777216|e|g<<8|c<<16).toString(16).substring(1)};c.getContigRanges=function(a){const b=[];let c=a[0],g=a[0];if(0<a.length)for(let d=0;d<a.length;d++){let e=a[d];1<e-c?(b.push([g,c]),g=e,d===a.length-1&&b.push([e,e])):d===a.length-1&&b.push([g,e]);
c=e}return b};(function(){NgChm.exportToNS("NgChm.UTIL",{showSplashExample:function(){const a=document.getElementById("splashWaiting");if(a){var b=document.getElementById("splashExample");a.classList.add("hide");b.classList.remove("hide")}},showLoader:function(c){const d=document.getElementById("splash"),e=document.getElementById("loader");b+="<P>"+c;e.innerHTML=b;a&&(e.classList.replace("faded","fadeinslow"),d&&d.classList.replace("fadeinslow","fadeout"),a=!1)},hideLoader:function(a){document.getElementById("loader").classList.replace("fadeinslow",
"fadeout");a&&([...document.querySelectorAll("*[data-hide-on-load]")].forEach(a=>a.classList.add("hide")),c.containerElement.classList.replace("faded","fadein"),[...document.querySelectorAll("*[data-show-on-load]")].forEach(a=>a.classList.remove("hide")))}});var a=!0,b=""})();(function(){String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return this.substr(b||0,a.length)===a});Element.prototype.remove||(Element.prototype.remove=function(){this.parentElement.removeChild(this)})})();
(function(){var a=0,b=document.createElement("div");b.innerHTML="<div><p>a b c d e f g h i j k l m n o p q r s t u v w x y z</p></div>";b.style.position="absolute";b.style.fontSize="1px";b.style.width="64px";document.body.appendChild(b);for(var d=b.offsetHeight,g=0,e=64,f,h=0;32>h&&5<=e;++h)f=(g+e)/2,b.style.fontSize=f+"px",b.offsetHeight===d?g=f:e=f;5<f&&(a=f,c.minLabelSize=Math.floor(f)-1);document.body.removeChild(b);return a})();(function(){let a=!1;"IE"===c.getBrowserType()&&(a=!0);5<c.minLabelSize&&
(a=!0);const b=document.getElementById("messageOpen_btn");void 0!=b&&(b.style.display=a?"":"none")})();document.getElementById("srchCovSelectBox").onclick=function(a){c.showCheckBoxDropDown("srchCovCheckBoxes")}})();
'use strict';(function(){NgChm.markFile();const a=NgChm.createNS("NgChm.CM"),m=NgChm.importNS("NgChm.UTIL");a.jsonConfigStr='{"row_configuration": {"classifications": {"show": "Y","height": 15,"bar_type": "color_plot","fg_color": "#000000","bg_color": "#FFFFFF","low_bound": "0","high_bound": "100"},"classifications_order": 1,"organization": {"agglomeration_method": "unknown","order_method": "unknown","distance_metric": "unknown"},"dendrogram": {"show": "ALL","height": "100"},"label_display_length": "20","label_display_method": "END","top_items": "[]"},"col_configuration": {"classifications": {"show": "Y","height": 15,"bar_type": "color_plot","fg_color": "#000000","bg_color": "#FFFFFF","low_bound": "0","high_bound": "100"},"classifications_order": 1,"organization": {"agglomeration_method": "unknown","order_method": "unknown","distance_metric": "unknown"},"dendrogram": {"show": "ALL","height": "100"},"label_display_length": "20","label_display_method": "END","top_items": "[]"},"data_configuration": {"map_information": {"data_layer": {"name": "Data Layer","grid_show": "Y","grid_color": "#FFFFFF","selection_color": "#00FF38","cuts_color": "#FFFFFF"},"name": "CHM Name","description": "Full length description of this heatmap","summary_width": "50","builder_version": "NA","summary_height": "100","detail_width": "50","detail_height": "100","read_only": "N","version_id": "1.0.0","map_cut_rows": "0","map_cut_cols": "0"}}}';
a.version="2.24.0";a.versionCheckUrl="https://bioinformatics.mdanderson.org/versioncheck/NGCHM/";a.viewerAppUrl="https://bioinformatics.mdanderson.org/ngchm/ZipAppDownload";a.classOrderStr=".classifications_order";a.CompatibilityManager=function(b){var e=!1,g=JSON.parse(a.jsonConfigStr),f={};a.buildConfigComparisonObject(g,"",f,b);g={};a.buildConfigComparisonObject(b,"",g);for(var d in f){var c=d,h=!1;c.includes(a.classOrderStr)&&(c+=".0",h=!0);var l=f[d],k=!1;for(d in g)if(d===c){k=!0;break}if(!k)if(h)a.hasClasses(b,
c)&&(e=!0);else{h=c.substring(1,c.lastIndexOf("."));e=c.substring(c.lastIndexOf(".")+1,c.length);c=h.split(".");"classifications"===c[1]&&(c[2]=a.trimClassLabel(c));h=b;for(k=0;k<c.length;k++)h=h[c[k]];"[]"==l&&(l=[]);h[e]=l;e=!0}}return e};a.trimClassLabel=function(b){if(3<b.length){for(var e="",a=b.length-1;3<=a;a--)e="."+b[a]+e,b.splice(a,1);b=b[2]+e}else b=b[2];return b};a.hasClasses=function(b,e){if(e.includes(".row_configuration.")){if(0<Object.keys(b.row_configuration.classifications).length)return!0}else if(0<
Object.keys(b.col_configuration.classifications).length)return!0;return!1};a.buildConfigComparisonObject=function(b,e,g,f){for(var d in b)if(b.hasOwnProperty(d))if("object"==typeof b[d])"undefined"===typeof f&&"top_items"===d?g[e+"."+d]=b[d]:a.buildConfigComparisonObject(b[d],e+"."+d,g,f);else{var c=e+"."+d;if("undefined"!==typeof f)if(-1<e.indexOf("row_configuration.classifications")){c=f.row_configuration.classifications;for(let a in c)g[e+"."+a+"."+d]=b[d]}else if(-1<e.indexOf("col_configuration.classifications")){c=
f.col_configuration.classifications;for(let a in c)g[e+"."+a+"."+d]=b[d]}else if(-1<e.indexOf("data_layer")){c=f.data_configuration.map_information.data_layer;for(let a in c){c=e+"."+a+"."+d;let f=b[d];"name"===d&&(f=f+" "+a);g[c]=f}}else g[c]=b[d];else g[c]=b[d]}};a.mapDataCompatibility=function(b){var a=!1;Array.isArray(b.col_data.label.label_type)||(a=m.convertToArray(b.col_data.label.label_type),b.col_data.label.label_type=a,a=!0);Array.isArray(b.row_data.label.label_type)||(a=m.convertToArray(b.row_data.label.label_type),
b.row_data.label.label_type=a,a=!0);return a}})();
'use strict';(function(){function l(){return"flickUp"===g.dataset.state}function f(a){var b=g.dataset.state;let c=("flickUp"===b?d.value:e.value)||"dl1",f=!1;"toggle"===a?(a="flickUp"===b?"flick2":"flick1",b=m(a),c!==b&&(c=b,f=!0)):"flick1"===a&&"flickUp"===b?f=!0:"flick2"===a&&"flickDown"===b?f=!0:c=("flick1"===a?d.value:e.value)||"dl1";return{flickElement:a,layer:c,redrawRequired:f}}function m(a){g.dataset.state="flick1"===a?"flickUp":"flickDown";return("flick1"===a?d.value:e.value)||"dl1"}NgChm.markFile();
NgChm.createNS("NgChm.FLICK",{enableFlicks:function(a,b,c){d.innerHTML=b;e.innerHTML=b;g.dataset.state="flickUp"==c.flick_btn_state||"flickDown"==c.flick_btn_state?c.flick_btn_state:"flickUp";d.value=a.includes(c.flick1)?c.flick1:a[0];a.includes(c.flick2)?e.value=c.flick2:e.value=2>a.length||a[1]==d.value?a[0]:a[1];h.style.display="";return l()?d.value:e.value},disableFlicks:function(){h.style.display="none"},flickIsOn:function(){return""===h.style.display},isFlickUp:l,getFlickState:function(){const a=
{element:"flick1",layer:d.value||"dl1"};if("none"==h.style.display)return[a];{const b={element:"flick2",layer:e.value};return"flickUp"===g.dataset.state?[a,b]:[b,a]}},setFlickState:m,toggleFlickState:f,setFlickHandler:function(a){document.getElementById("flick_btn").onclick=function(b){a(f("toggle"))};document.getElementById("flick1").onchange=function(b){a(f("flick1"))};document.getElementById("flick2").onchange=function(b){a(f("flick2"))}},getFlickSaveState:function(){return{flick_btn_state:g.dataset.state,
flick1:d.value,flick2:e.value}}});const h=document.getElementById("layer_control"),k=document.getElementById("layers_open_close");document.getElementById("flick_btn");const g=document.getElementById("flickViews"),d=document.getElementById("flick1"),e=document.getElementById("flick2");k.onclick=function(a){"closed"==k.dataset.state?(d.selectedIndex===e.selectedIndex&&(e.selectedIndex=0===d.selectedIndex?1:0),g.style.display="",k.dataset.state="open"):(g.style.display="none",k.dataset.state="closed")}})();
'use strict';(function(){function q(b,c,d,e,h){"function"==typeof e&&(h=e,e="missing - deprecated");const l=b.querySelector(".msgBoxButtons"),f=document.createElement("button");f.id="msgBoxBtn_"+c;"object"!=typeof d&&(d={type:"image",src:d});"image"==d.type?(c=document.createElement("img"),c.src=d.src,c.alt=d.alt||e,f.appendChild(c)):(e=g.newElement("span.button"),e.innerText=d.text,c=g.newElement("span.spanbuttonwrapper"),c.appendChild(e),f.appendChild(c));d.default&&f.classList.add("default");d.disabled?
(f.disabled=!0,f.dataset.tooltip=(d.tooltip?d.tooltip+". ":"")+"Disabled because "+(d.disabledReason||"of unspecified reason")):d.tooltip&&(f.dataset.tooltip=d.tooltip+".");f.onclick=void 0==h?()=>{b==document.getElementById("msgBox")?a.messageBoxCancel():document.body.removeChild(b)}:function(b){d.disableOnClick&&(f.disabled=!0);h(f)};l.appendChild(f)}NgChm.markFile();const a=NgChm.createNS("NgChm.UHM"),g=NgChm.importNS("NgChm.UTIL");a.postMapDetails=!1;a.postMapToWhom=null;a.myNonce="N";var m=null,
n=null;(function(){document.getElementById("messageOpen_btn").onclick=()=>{a.displayStartupWarnings()}})();(function(){function b(b){let a=b;for(;a;){if("button"==a.tagName.toLowerCase()||a.dataset.hasOwnProperty("tooltip")||a.dataset.hasOwnProperty("title"))return a;a=a.parentElement}return b}document.addEventListener("mouseover",function(c){c=b(c.target);c.dataset.hovering="";if(c.dataset.tooltip){let b=c.dataset.tooltip;c.disabled&&c.dataset.disabledReason&&(b+=" "+c.dataset.disabledReason);a.hlp(c,
b,140,0)}},{passive:!0});document.addEventListener("mouseout",function(a){delete b(a.target).dataset.hovering},{passive:!0});document.addEventListener("click",function(b){a.hlpC();a.closeMenu();[...document.getElementsByClassName("remove-on-click")].forEach(b=>{b.remove()})},{passive:!0})})();a.processMessage=function(b){""===a.myNonce&&(a.myNonce=g.getURLParameter("nonce"));""!==a.myNonce&&b.data&&b.data.nonce===a.myNonce&&("ShowMapDetail"===b.data.override&&(a.postMapDetails=!0,a.postMapToWhom=
b.origin),null!=b.data.ngchm_id&&(a.postID=b.data.ngchm_id))};window.addEventListener("message",a.processMessage,!1);a.formatMapDetails=function(b,c){b.insertRow().innerHTML=a.formatBlankRow();a.setTableRow(b,["<u>Data Details</u>","&nbsp;"],2);a.setTableRow(b,["&nbsp;Value:",c.value]);a.setTableRow(b,["&nbsp;Row:",c.rowLabel]);a.setTableRow(b,["&nbsp;Column:",c.colLabel]);0<c.rowCovariates.length&&(b.insertRow().innerHTML=a.formatBlankRow(),a.setTableRow(b,["&nbsp;<u>Row Covariates</u>","&nbsp;"],
2),c.rowCovariates.forEach(c=>{const d=20<c.name.length?c.name.substring(0,20)+"...":c.name;a.setTableRow(b,["&nbsp;&nbsp;&nbsp;"+d+":</u>",c.value])}));0<c.colCovariates.length&&(b.insertRow().innerHTML=a.formatBlankRow(),a.setTableRow(b,["&nbsp;<u>Column Covariates</u>","&nbsp;"],2),c.colCovariates.forEach(c=>{const d=20<c.name.length?c.name.substring(0,20)+"...":c.name;a.setTableRow(b,["&nbsp;&nbsp;&nbsp;"+d+":</u>",c.value])}))};a.pasteHelpContents=function(){var b=document.getElementById("helpTable");
window.open("","","width=500,height=330,resizable=1").document.write(b.innerText.replace(/(\r\n|\n|\r)/gm,"<br>"))};a.hlp=function(b,c,d,e,h=500){b!=n&&(a.hlpC(),n=b,m=setTimeout(function(){const h=document.querySelector("body");if(h&&""==b.dataset.hovering){var f=a.getElemPosition(b),k=g.newElement("span.title",{},[g.newTxt(b.dataset.title||"")]),p=g.newElement("span.intro",{},[b.dataset.intro||c]);k=g.newElement("div#bubbleHelp",{},[k,p]);void 0!==e?(p=f.left-d,0>p&&(p=0),k.style.left=p+"px"):k.style.left=
f.left+"px";k.style.top=f.top+40+"px";k.innerHTML="<b><font size='2' color='#0843c1'>"+c+"</font></b>";k.style.display="inherit";h.appendChild(k);m=null;setTimeout(()=>{n==b&&(n=null,a.hlpC())},5E3)}},h))};a.getElemPosition=function(b){for(var a=0,d=0;b&&!isNaN(b.offsetLeft)&&!isNaN(b.offsetTop);)a+=b.offsetLeft-b.scrollLeft,d+=b.offsetTop-b.scrollTop,b=b.offsetParent;return{top:d,left:a}};a.hlpC=function(){null!==m&&(clearTimeout(m),n=m=null);let a=document.getElementById("bubbleHelp");null===a&&
(a=document.getElementById("helptext"));a&&a.remove()};a.getDivElement=function(a){var b=document.createElement("div");b.id=a;b.style.backgroundColor="#CBDBF6";b.style.display="none";return b};a.setTableRow=function(a,c,d,e){a=a.insertRow();a.className="chmTblRow";for(var b=0;b<c.length;b++){var l=a.insertCell(b);"undefined"!=typeof d&&(l.colSpan=d);0===b&&(l.style.fontWeight="bold");["string","number"].includes(typeof c[b])||Array.isArray(c[b])?l.innerHTML=c[b]:c[b]&&l.appendChild(c[b]);"undefined"!=
typeof e&&(l.align=e)}};a.setTableRowX=function(a,c,d,e){d=d||[];e=e||Array(c.length);const b=a.insertRow();b.classList.add("chmTblRow");d.forEach(a=>{b.classList.add(a)});1==b.classList.length&&b.classList.add("entry");for(a=0;a<c.length;a++){const d=b.insertCell(a);for(let [b,c]of Object.entries(e[a]||{}))if("object"!=typeof c)d[b]=c;else if("style"==b)for(let [a,b]of Object.entries(c))d.style[a]=b;else if("classList"==b)c.forEach(a=>d.classList.add(a));else if("dataset"==b)for(let [a,b]of Object.entries(c))d.dataset[a]=
b;else console.error("Unknown object in tdProps: "+b);0==d.classList.length&&d.classList.add(0==a?"label":"value");["string","number"].includes(typeof c[a])||Array.isArray(c[a])?d.innerHTML=c[a]:c[a]&&d.appendChild(c[a])}};a.formatBlankRow=function(){return"<td style='line-height:4px;' colspan=2>&nbsp;</td>"};a.addBlankRow=function(b,c){b.insertRow().innerHTML=a.formatBlankRow();if("undefined"!==typeof c)for(var d=1;d<c;d++)b.insertRow().innerHTML=a.formatBlankRow()};a.hamburgerLinkMissing=function(){a.initMessageBox();
a.setMessageBoxHeader("NG-CHM Menu Link Error");a.setMessageBoxText("<br>No destination has been defined for the menu link.");a.setMessageBoxButton("cancel",{type:"text",text:"Cancel"},"Cancel button",a.messageBoxCancel);a.displayMessageBox()};a.systemMessage=function(b,c){a.initMessageBox();a.setMessageBoxHeader(b);a.setMessageBoxText("<br>"+c);a.setMessageBoxButton("cancel",{type:"text",text:"Cancel"},"Cancel button",a.messageBoxCancel);a.displayMessageBox()};a.noWebGlContext=function(b){a.initMessageBox();
a.setMessageBoxHeader("ERROR: WebGL Initialization Failed");b?a.setMessageBoxText("<br>WebGL is available but is not enabled on your machine.  The NG-CHM Application requires the WebGL Javascript API in order to render images of Next Generation Clustered Heat Maps.<br><br>Instructions for enabling WebGL, based on browser type, can be found via a web search."):a.setMessageBoxText("<br>No WebGL context is available.  The NG-CHM Application requires the WebGL Javascript API in order to render images of Next Generation Clustered Heat Maps. Most web browsers and graphics processors support WebGL.<br><br>Please ensure that the browser that you are using and your computer's processor are WebGL compatible.");
a.setMessageBoxButton("cancel",{type:"text",text:"Cancel"},"Cancel button",a.messageBoxCancel);a.displayMessageBox()};a.mapNotFound=function(b){g.hideLoader(!1);a.initMessageBox();a.setMessageBoxHeader("Requested Heat Map Not Found");a.setMessageBoxText("<br>The Heat Map ("+b+") that you requested cannot be found OR connectivity to the Heat Map repository has been interrupted.<br><br>Please check the Heat Map name and try again.");a.setMessageBoxButton("cancel",{type:"text",text:"Cancel"},"Cancel button",
a.messageBoxCancel);a.displayMessageBox()};a.mapLoadError=function(b,c){g.hideLoader(!1);a.initMessageBox();a.setMessageBoxHeader("Requested Heat Map Not Loaded");a.setMessageBoxText("<br>The Heat Map ("+b+") that you selected cannot be loaded.<br><br>Reason: "+c);a.setMessageBoxButton("cancel",{type:"text",text:"Cancel"},"Cancel button",a.messageBoxCancel);a.displayMessageBox()};a.linkoutError=function(b){a.initMessageBox();a.setMessageBoxHeader("Heat Map Linkout");a.setMessageBoxText(b);a.setMessageBoxButton("cancel",
{type:"text",text:"Cancel"},"Cancel button",a.messageBoxCancel);a.displayMessageBox()};a.invalidFileFormat=function(){a.initMessageBox();a.setMessageBoxHeader("Invalid File Format");a.setMessageBoxText("<br>The file chosen is not an NG-CHM file.<br><br>Please select a .ngchm file and try again.");a.setMessageBoxButton("cancel",{type:"text",text:"Cancel"},"Cancel button",a.messageBoxCancel);a.displayMessageBox()};a.initMessageBox=function(){a.hideMsgBoxProgressBar();const b=document.getElementById("msgBox");
for(;0<b.classList.length;)b.classList.remove(b.classList[0]);b.style.display="none";b.style.width="";const c=b.querySelector(".msgBoxButtons");for(;c.firstChild;)c.removeChild(c.firstChild);document.getElementById("messageOpen_btn").style.display="none";return b};a.messageBoxIsVisible=function(){const a=document.getElementById("msgBox");return a&&"none"!=a.style.display};a.setMessageBoxHeader=function(b){var c=document.getElementById("msgBoxHdr");c.innerHTML="<SPAN>"+b+"</SPAN>";c.querySelector(".closeX")&&
c.querySelector(".closeX").remove();c.appendChild(a.createCloseX(a.messageBoxCancel))};a.getMessageTextBox=function(){return document.getElementById("msgBoxTxt")};a.setMessageBoxText=function(a){document.getElementById("msgBoxTxt").innerHTML=a};a.displayMessageBox=function(){let a=document.getElementById("msgBox");a.style.display="";a.style.left=(window.innerWidth-a.offsetWidth)/2+"px";let c=document.getElementById("mdaServiceHeader");a.style.top=c.offsetTop+15+"px"};a.setMessageBoxButton=function(a,
c,d,e){const b=document.getElementById("msgBox");q(b,a,c,d,e)};a.showMsgBoxProgressBar=function(){document.getElementById("msgBoxProgressDiv").style.display="";document.getElementById("msgBoxProgressBar").value=0};a.hideMsgBoxProgressBar=function(){document.getElementById("msgBoxProgressDiv").style.display="none"};a.isProgressBarVisible=function(){return""==document.getElementById("msgBoxProgressDiv").style.display};a.msgBoxProgressMeter=function(a){document.getElementById("msgBoxProgressBar").value=
a;return"true"!=document.getElementById("msgBoxProgressBar").dataset.cancelled};a.cancelOperation=function(){document.getElementById("msgBoxProgressBar").dataset.cancelled="true";document.getElementById("msgBoxProgressDiv").style.opacity=.5};a.messageBoxCancel=function(){a.initMessageBox()};a.newMessageBox=function(a){a="msgBox-for-"+a;var b=document.getElementById(a);if(b)return b;b=document.querySelector("template#msgBoxTemplate").content.querySelector("div").cloneNode(!0);b.classList.add("hide");
b.id=a;document.body.appendChild(b);g.dragElement(b);return b};a.setNewMessageBoxHeader=function(b,c){const d=b.querySelector(".msgBoxHdr");d.innerHTML="<SPAN>"+c+"</SPAN>";d.querySelector(".closeX")&&d.querySelector(".closeX").remove();d.appendChild(a.createCloseX(()=>{a.closeNewMessageBox(b)}))};a.getNewMessageTextBox=function(a){return a.querySelector(".msgBoxTxt")};a.setNewMessageBoxButton=function(b,c,d,e){e||(e=()=>{a.closeNewMessageBox(b)});q(b,c,d,e)};a.displayNewMessageBox=function(a){a.classList.remove("hide")};
a.closeNewMessageBox=function(a){document.body.removeChild(a)};a.closeMenu=function(){const a=document.getElementById("barMenu_btn");null===a||a.dataset.hasOwnProperty("hovering")||(document.getElementById("burgerMenuPanel").style.display="none")};a.displayStartupWarnings=function(){a.hlpC();a.initMessageBox();var b="NG-CHM Startup Warning",c="",d=!1,e=1;"IE"===g.getBrowserType()?c="<br><b>Unsupported Browser Warning:</b> Your current browser is Internet Explorer. The NG-CHM application is optimized for use with the Google Chrome and Mozilla Firefox browsers.  While you may view maps in IE, the performance of the application cannot be guaranteed.<br><br>You may wish to switch to one of these supported browsers.":
(11<g.minLabelSize&&(d&&(c+="<br>"),c+="<br><b>Minimum Font Warning:</b> Current browser settings include a minimum font size setting that is too large. This will block the display of row, column, and covariate bar labels in the NG-CHM application. You may wish to turn off or adjust this setting in your browser.",d=!0,e++),5<g.minLabelSize&&(d&&(c+="<br>"),c+="<br><b>Minimum Font Warning:</b> Current browser settings include a minimum font size setting. This may interfere with the display of row, column, and covariate bar labels in the NG-CHM application. You may wish to turn off or adjust this setting in your browser.",
e++));2<e&&(b+="s");a.setMessageBoxHeader(b);a.setMessageBoxText(c);a.setMessageBoxButton("cancel",{type:"text",text:"Cancel"},"Cancel button",a.messageBoxCancel);a.displayMessageBox()};a.createCloseX=function(a){const b=g.newSvgButton("icon-big-x.red");b.onclick=a;return g.newElement("SPAN.closeX",{},[b])}})();
'use strict';(function(){NgChm.markFile();const a=NgChm.createNS("NgChm.MAPREP");a.maxValues=2147483647;a.minValues=-2147483647;a.THUMBNAIL_LEVEL="tn";a.SUMMARY_LEVEL="s";a.RIBBON_VERT_LEVEL="rv";a.RIBBON_HOR_LEVEL="rh";a.DETAIL_LEVEL="d"})();
'use strict';(function(){function f(d){return(d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(d))?{r:parseInt(d[1],16),g:parseInt(d[2],16),b:parseInt(d[3],16),a:255}:null}NgChm.markFile();const k=NgChm.createNS("NgChm.CMM"),q=NgChm.importNS("NgChm.MAPREP");k.ColorMap=function(d,g){function l(a,c){for(var e={},b=0;b<r;){if(c[b]<=a&&a<c[b+1]){e.upper=b+1;e.lower=b;break}b++}return e}function v(a,c,e){a=(a-e[c])/(e[c+1]-e[c]);e=h[c];c=h[c+1];const b={};b.r=Math.round(e.r*(1-a)+c.r*a);b.g=Math.round(e.g*
(1-a)+c.g*a);b.b=Math.round(e.b*(1-a)+c.b*a);b.a=255;return b}function w(a){const {r:c,g:e,b}=a;return"#"+m(c)+m(e)+m(b)}function m(a){a=a.toString(16);return 1==a.length?"0"+a:a}this.heatMap=d;var t=g.type;var b="quantile"==t?g.linearEquiv:g.thresholds;var r=b.length,n=g.colors,u=g.missing,h=[],p;if(void 0!=g.rgbaColors)h=g.rgbaColors;else for(d=0;d<r;d++)h[d]=f(n[d]);void 0!=g.rgbaMissingColor?rgbaMissingColors=g.rgbaMissingColor:p=f(u);this.getThresholds=function(){return b};this.setThresholds=
function(a){b=a};this.getContinuousThresholdKeys=function(){const a=[],c=b[0],e=this.getContinuousThresholdKeySize();a.push(c);for(let b=1;8>=b;b++)a.push(c+e*b);a.push(b[b.length-1]);return a};this.getContinuousThresholdKeySize=function(){return(b[b.length-1]-b[0])/9};this.getColors=function(){return n};this.setColors=function(a){n=a};this.getType=function(){return t};this.getMissingColor=function(){return u};this.setMissingColor=function(a){u=a};class x{constructor(a,c){this.minBreak=c[0];this.maxIdx=
c.length-1;this.maxBreak=c[this.maxIdx];this.thresholds=c;this.cutsColor=a.getCutsColor()}getColor(a){return"Missing"===a||isNaN(a)?p:this.contColor(+a)}contColor(a){if(a<=this.minBreak)return a<=q.minValues?this.cutsColor:h[0];if(a>=this.maxBreak)return a>=q.maxValues?p:h[this.maxIdx];{let c;if(a<this.thresholds[1])c=0;else if(a<this.thresholds[2])c=1;else for(c=2;a>=this.thresholds[c+1];)c++;return v(a,c,this.thresholds)}}}this.getContColorMap=function(){return new x(this,b)};this.getCutsColor=
function(){const a=this.heatMap.getDataLayers()[this.heatMap.getCurrentDL()];return"undefined"!==typeof a.cuts_color?f(a.cuts_color):{r:255,g:255,b:255,a:255}};this.getColor=function(a){if(a>=q.maxValues||"Missing"==a||isNaN(a))a=p;else if(a<=q.minValues)a=this.getCutsColor();else if(a<=b[0])a=h[0];else if(a>=b[r-1])a=h[r-1];else{const c=l(a,b);a=v(a,c.lower,b)}return a};this.getClassificationColor=function(a){if("!CUT!"==a)return{r:255,g:255,b:255,a:255};if("discrete"==t){for(var c=0;c<b.length;c++)if(a==
b[c])return a=h[c];return p}return a=isNaN(a)?p:this.getColor(a)};this.addBreakpoint=function(a,c){var e=l(a,b);b.splice(e.lower,0,a);n.splice(e.lower,0,c);h.splice(e.lower,0,f(c))};this.changeBreakpoint=function(a,c){var e=l(a,b);b.splice(e.lower,1,a);n.splice(e.lower,1,c);h.splice(e.lower,1,f(c))};this.removeBreakpoint=function(a){a=l(a,b);b.splice(a.lower,1);n.splice(a.lower,1);h.splice(a.lower,1)};this.getColorLuminance=function(a){return(a=(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?
{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null)?.2126*a.r+.7152*a.g+.0722*a.b:null};this.isColorDark=function(a){return a?60>.2126*a.r+.7152*a.g+.0722*a.b?!1:!0:!1};this.getRgbToHex=function(a){var c=a.g,b=a.b;return"#"+m(a.r)+m(c)+m(b)};k.blendHexColors=function(a,c,b){a=f(a);c=f(c);return w({r:a.r*b+c.r*(1-b)|0,g:a.g*b+c.g*(1-b)|0,b:a.b*b+c.b*(1-b)|0,a:a.a*b+c.a*(1-b)|0})};k.darkenHexColorIfNeeded=function(a){const {r:c,g:b,b:d}=f(a),l=Math.min(c,b,d);if(240>=l)return a;a=240/
l;return w({r:c*a|0,g:b*a|0,b:d*a|0})}};k.ColorMapManager=function(d){this.heatMap=d;d=d.mapConfig;const g=[d.data_configuration.map_information.data_layer,d.row_configuration.classifications,d.col_configuration.classifications];this.getColorMap=function(d,f){return new k.ColorMap(this.heatMap,g["data"===d?0:"row"===d?1:2][f].color_map)};this.setColorMap=function(d,f,k){d=g["data"===k?0:"row"===k?1:2][d].color_map;d.colors=f.getColors();d.thresholds=f.getThresholds();d.missing=f.getMissingColor()}};
k.hexToRgba=f})();
'use strict';(function(){function x(b,c,d){const a=document.createElement("form");a.action=c;a.method=b;d&&(b=document.createElement("textarea"),b.name="configData",b.id="configData",b.value=d,a.appendChild(b));a.style.display="none";document.body.appendChild(a);a.submit()}function D(b,c,d){const a={mapConfig:c,mapData:d};g.webLoader.setMessageHandler(function(f){if("tileLoaded"===f.data.op){const a=new Float32Array(f.data.buffer);b.tileRequestComplete(f.data.job.tileCacheName,a)}else if("tileLoadFailed"===
f.data.op)b.tileRequestComplete(f.data.job.tileCacheName,null);else if("jsonLoaded"===f.data.op)if(a.hasOwnProperty(f.data.name))a[f.data.name](b,f.data.json);else console.log({m:"connectWebLoader: unknown JSON request",e:f});else"jsonLoadFailed"===f.data.op?(console.error(`Failed to get JSON file ${f.data.name} for ${b.mapName} from server`),m.mapNotFound(b.mapName)):console.log({m:"connectWebLoader: unknown op",e:f})})}function n(b){return b&&"row"===b.toLowerCase()}function e(b,c,d,a,f){this.unAppliedChanges=
this.initialized=!1;this.mapName=b;this.mapData=this.mapConfig=null;this.datalevels={};this.alternateLevels={};this.colorMapMgr=null;this.fileSrc=d;this.chmFile=a;this.zipFiles={};this.currentTileRequests=[];this.pendingTileRequests=[];this.initEventListeners(c);this.initTileWindows();this.tileCache=new E(this);this.source()!==g.FILE_SOURCE?(this.source()!==g.WEB_SOURCE&&createWebLoader(this.source()),D(this,f.addMapConfig,f.addMapData)):("undefined"===typeof embedDiv&&F(this),G(this,f.addMapConfig,
f.addMapData))}function H(b){function c(a,f,c){d.hasOwnProperty(a)?b.datalevels[a]=new I(b.tileCache,a,d[a],f?b.datalevels[f]:null):c&&(b.datalevels[a]=b.datalevels[c],b.alternateLevels.hasOwnProperty(c)||(b.alternateLevels[c]=[]),b.alternateLevels[c].push(a))}const d=b.mapConfig.data_configuration.map_information.levels;c(k.THUMBNAIL_LEVEL);c(k.SUMMARY_LEVEL,k.THUMBNAIL_LEVEL,k.THUMBNAIL_LEVEL);c(k.DETAIL_LEVEL,k.SUMMARY_LEVEL,k.SUMMARY_LEVEL);c(k.RIBBON_VERT_LEVEL,k.SUMMARY_LEVEL,k.DETAIL_LEVEL);
c(k.RIBBON_HOR_LEVEL,k.SUMMARY_LEVEL,k.DETAIL_LEVEL);J(b);b.sendCallBack(g.Event_INITIALIZED)}function J(b){b.thumbnailWindowRefs=Object.keys(b.mapConfig.data_configuration.map_information.data_layer).map(c=>b.getNewAccessWindow({layer:c,level:k.THUMBNAIL_LEVEL,firstRow:1,firstCol:1,numRows:b.getNumRows(k.THUMBNAIL_LEVEL),numCols:b.getNumColumns(k.THUMBNAIL_LEVEL)}))}function y(b,c){m.initMessageBox().classList.add("file-viewer");m.setMessageBoxHeader(b);m.setMessageBoxText(c);m.setMessageBoxButton("download",
{type:"text",text:"Download Viewer"},"Download viewer button",()=>{g.zipAppDownload();m.messageBoxCancel()});m.setMessageBoxButton("cancel",{type:"text",text:"Cancel",default:!0},"Cancel button",m.messageBoxCancel);m.displayMessageBox()}function F(b){function c(a,b){a=a.split(".").map(a=>a|0);b=b.split(".").map(a=>a|0);for(let f=0;;f++){if(f==a.length&&f==b.length)return!1;if(f==b.length)return!0;if(f==a.length)return!1;if(a[f]>b[f])return!0;if(a[f]<b[f])return!1}}const d=new XMLHttpRequest,a=r.version.replace(/-.*$/,
"");d.open("GET",r.versionCheckUrl+a,!0);d.onreadystatechange=function(){if(d.readyState==d.DONE)if(200!=d.status)console.log("Failed to get software version: "+d.status);else{const f=d.response;c(f,a)&&"undefined"===typeof NgChm.galaxy&&null===g.embeddedMapName&&b.source()!=g.WEB_SOURCE&&y("New NG-CHM File Viewer Version Available","<br>The version of the NG-CHM File Viewer application that you are running ("+r.version+") has been superceded by a newer version ("+f+"). You will be able to view all pre-existing heat maps with this new backward-compatible version. However, you may wish to download the latest version of the viewer.<br><br>The application downloads as a single HTML file (ngchmApp.html).  When the download completes, you may run the application by simply double-clicking on the downloaded file.  You may want to save this file to a location of your choice on your computer for future use.<br><br>")}};
d.send()}function G(b,c,d){function a(a,b,c){b.getData(new zip.TextWriter,{}).then(b=>{c(a,JSON.parse(b))})}0===b.chmFile.size?m.mapLoadError(b.chmFile.name,"File is empty (zero bytes)"):(new zip.ZipReader(new zip.BlobReader(b.chmFile))).getEntries().then(function(f){if(0==f.length)m.mapLoadError(b.chmFile.name,"Empty zip file");else{var l=f[0].filename,h=l.indexOf("/");if(0>h)m.mapLoadError(b.chmFile.name,"File format not recognized");else{b.mapName=l.substring(0,h);for(l=0;l<f.length;l++)b.zipFiles[f[l].filename]=
f[l];var e=b.mapName+"/mapConfig.json",p=b.mapName+"/mapData.json";e in b.zipFiles&&p in b.zipFiles?(setTimeout(()=>{a(b,b.zipFiles[e],c)}),setTimeout(()=>{a(b,b.zipFiles[p],d)})):m.mapLoadError(b.chmFile.name,"Missing NGCHM content")}}}).catch(function(a){console.log("Zip file read error "+a);m.mapLoadError(b.chmFile.name,a)})}function K(b,c){const d=b.mapName+"/"+c.layer+"/"+c.level+"/"+c.tileName;let a=b.zipFiles[d+".tile"];"undefined"===typeof a&&(a=b.zipFiles[d+".bin"]);"undefined"===typeof a?
(console.error("Request for unknown zip tile: "+d),b.tileRequestComplete(c.tileCacheName,null)):setTimeout(function(){a.getData(new zip.BlobWriter).then(function(a){const f=new FileReader;f.onerror=function(){console.error("Error in zip file reader",f.error);b.tileRequestComplete(c.tileCacheName,null)};f.onload=function(a){a=new Float32Array(f.result);b.tileRequestComplete(c.tileCacheName,a)};f.readAsArrayBuffer(a)}).catch(a=>{console.error("Error getting zip tile data",a)})},1)}NgChm.markFile();
const g=NgChm.createNS("NgChm.MMGR"),q=NgChm.importNS("NgChm.UTIL"),A=NgChm.importNS("NgChm.FLICK"),k=NgChm.importNS("NgChm.MAPREP"),t=NgChm.importNS("NgChm.CFG"),u=NgChm.importNS("NgChm.CMM"),m=NgChm.importNS("NgChm.UHM"),r=NgChm.importNS("NgChm.CM");g.webLoader=null;g.WEB_SOURCE="W";g.LOCAL_SOURCE="L";g.FILE_SOURCE="F";g.Event_INITIALIZED="Init";g.Event_JSON="Json";g.Event_NEWDATA="NewData";g.embeddedMapName=null;g.localRepository="/NGCHM";g.createWebLoader=function(b){function c(a){if(active===
maxActiveRequests)pending.push(a);else{active++;var b=new XMLHttpRequest;b.open("GET",tileURL(a),!0);b.responseType="arraybuffer";b.onreadystatechange=function(){b.readyState==b.DONE&&(active--,0<pending.length&&c(pending.shift()),200!=b.status?postMessage({op:"tileLoadFailed",job:a}):postMessage({op:"tileLoaded",job:a,buffer:b.response},[b.response]))};b.send()}}function d(a){const b=new XMLHttpRequest;b.open("GET",jsonFileURL(a),!0);b.responseType="json";b.onreadystatechange=function(){b.readyState==
b.DONE&&(200!=b.status?postMessage({op:"jsonLoadFailed",name:a}):postMessage({op:"jsonLoaded",name:a,json:b.response}))};b.send()}function a(a){"loadTile"===a.data.op?c(a.data.job):"loadJSON"===a.data.op&&d(a.data.name)}function f(){d("mapConfig");d("mapData")}const l=function(a){a==g.WEB_SOURCE?(a=document.location.origin,"/"!==t.api[0]&&(a+="/"+window.location.pathname.substr(1,window.location.pathname.lastIndexOf("/"))),a+=t.api):(console.log(`getLoaderBaseURL: fileSrc==${a}`),a=g.localRepository+
"/"+g.embeddedMapName+"/");return a}(b);var h="const debug = false;const maxActiveRequests = 2;var active = 0;const pending = [];"+`const baseURL = "${l}";`+`var mapId = "${q.mapId}";`;h+=`const mapNameRef = "${q.mapNameRef}";`;h+="function tileURL(job){return baseURL+";h=b===g.WEB_SOURCE?h+'"GetTile?map=" + mapId + "&datalayer=" + job.layer + "&level=" + job.level + "&tile=" + job.tileName':h+'job.layer+"/"+job.level+"/"+job.tileName+".bin"';h+=";}";h+=c.toString();h+="function jsonFileURL(name){return baseURL+";
h=b===g.WEB_SOURCE?h+'"GetDescriptor?map=" + mapId + "&type=" + name':h+'name+".json"';h+=";}";h+=d.toString();h+=a.toString();h+=f.toString();""===q.mapId&&""!==q.mapNameRef?(b=function(){fetch(l+"GetMapByName/"+mapNameRef).then(a=>{200===a.status?a.json().then(a=>{mapId=a.data.id;f()}):postMessage({op:"jsonLoadFailed",name:"GetMapByName"})})},h+=b.toString(),h+=b.name+"();"):h+=f.name+"();";h+=`onmessage = ${a.name};`;h=new Blob([h],{type:"application/javascript"});g.webLoader=new Worker(URL.createObjectURL(h));
const e=[];g.webLoader.onmessage=function(a){e.push(a)};g.webLoader.setMessageHandler=function(a){setTimeout(function(){for(;0<e.length;)a(e.shift());g.webLoader.onmessage=a},0)}};g.isRow=n;class L{constructor(b,c){const {layer:d,level:a,startRowTile:f,endRowTile:l,startColTile:h,endColTile:e}=c;var g=b.datalevels[a];(1>f||l>g.numTileRows||1>h||e>g.numTileColumns||l<f||e<h)&&console.error("Constructing TileWindow with out-of-range tiles",c,g);this.heatMap=b;this.layer=d;this.level=a;this.startRowTile=
f;this.endRowTile=l;this.startColTile=h;this.endColTile=e;this.numColumnTiles=e-h+1;this.totalTiles=(l-f+1)*this.numColumnTiles;this.tiles=Array({length:this.totalTiles});this._allTilesAvailable=!0;b=0;for(c=this.startRowTile;c<=this.endRowTile;c++)for(g=this.startColTile;g<=this.endColTile;g++)this.tiles[b]=this.heatMap.tileCache.getTileCacheData(this.layer+"."+this.level+"."+c+"."+g),this.tiles[b]||(this._allTilesAvailable=!1),b++;this.tileStatusValid=!0}myKey(){return[this.layer,this.level,this.startRowTile,
this.endRowTile,this.startColTile,this.endColTile].join(".")}isTileInWindow(b){return b.layer===this.layer&&b.level===this.level&&b.row>=this.startRowTile&&b.row<=this.endRowTile&&b.col>=this.startColTile&&b.col<=this.endColTile}checkTile(b){b.hasOwnProperty("data")||console.error("NEWDATA message has no data field",b);if(this.isTileInWindow(b)){const c=(b.row-this.startRowTile)*this.numColumnTiles+b.col-this.startColTile;c>=this.totalTiles&&console.error("Tile idx out of range",{idx:c,tile:b,tileWindow:this});
this.tiles[c]=b.data;this.tileStatusValid=!1}}getTileData(b,c){if(b>=this.startRowTile&&b<=this.endRowTile&&c>=this.startColTile&&c<=this.endColTile)return this.tiles[(b-this.startRowTile)*this.numColumnTiles+c-this.startColTile];console.error("getTileData out of limits",{tileRow:b,tileCol:c,tileWindow:this});return null}fetchTiles(){let b=0;for(let c=this.startRowTile;c<=this.endRowTile;c++)for(let d=this.startColTile;d<=this.endColTile;d++)this.tiles[b]||(this.tiles[b]=this.heatMap.tileCache.getTileCacheData(this.layer+
"."+this.level+"."+c+"."+d),this.tiles[b]||(this.tiles[b]=this.heatMap.tileCache.getTile(this.layer,this.level,c,d))),b++}allTilesAvailable(){if(this.tileStatusValid)return this._allTilesAvailable;for(let b=0;b<this.totalTiles;b++)if(!this.tiles[b])return this._allTilesAvailable=!1,this.tileStatusValid=!0,!1;return this.tileStatusValid=this._allTilesAvailable=!0}onready(b){const c=this,d=new Promise((a,b)=>{function f(b,f){return f.layer==b.layer&&f.level==b.level&&b.allTilesAvailable()?(a(b),!0):
!1}c.allTilesAvailable()?a(c):c.heatMap.tileWindowListeners.push({tileWindow:c,checkReady:f})});if(b)d.then(b);else return d}}class E{constructor(b){this.heatMap=b;this.cacheEntries={};this.longestLoadTime=0}createTileCacheEntry(b){const [c,d,a,f]=b.split(".");return this.cacheEntries[b]={props:{layer:c,level:d,row:a|0,col:f|0},data:null,fetchTime:0,loadTime:0,fetches:0,failedFetches:0,dataSize:0}}haveTileData(b){return null!=this.getTileCacheData(b)}getTile(b,c,d,a){const f=b+"."+c+"."+d+"."+a;let l=
!0,h=this.cacheEntries[f];if(h){const a=this.getEntryData(f,h);if(a)return a;0<h.fetchTime&&(performance.now()-h.fetchTime<Math.max(3E3,1.25*this.longestLoadTime)?l=!1:h.failedFetches++)}else h=this.createTileCacheEntry(f);l&&(h.fetches++,h.fetchTime=performance.now());this.heatMap.loadHeatMapTile({tileCacheName:f,layer:b,level:c,tileName:c+"."+d+"."+a});return null}showTileCacheStats(){for(let b in this.cacheEntries){const c=this.cacheEntries[b];if(c.data){const d=c.loadTime-c.fetchTime;console.log({tileCacheName:b,
fetches:c.fetches,KBytes:c.dataSize/1024,loadTime:d,loadTimePerKByte:d/c.dataSize*1024})}}console.log("Longest load time: "+this.longestLoadTime)}resetTileCacheEntry(b){const c=this.cacheEntries[b];c&&(b=this.getEntryData(b,c),c.fetchTime=0,b||c.failedFetches++)}getTileCacheData(b){const c=this.cacheEntries[b];return c?this.getEntryData(b,c):null}getEntryData(b,c){if(null===c.data)return null;b=c.data.deref();null==b&&(c.data=null);return b}setTileCacheEntry(b,c){b=this.cacheEntries[b];b.loadTime=
performance.now();const d=b.loadTime-b.fetchTime;d>this.longestLoadTime&&(this.longestLoadTime=d);b.data=new WeakRef(c);b.dataSize=c.length;this.heatMap.updateTileWindows(Object.assign({},b.props,{data:c}))}}class M{constructor(b,c){this.heatMap=b;this.win={layer:c.layer,level:c.level,firstRow:c.firstRow|0,firstCol:c.firstCol|0,numRows:c.numRows|0,numCols:c.numCols|0};this.tileWindow=b.getTileWindow(this.win);this.tileWindow.fetchTiles();this.datalevel=b.datalevels[this.win.level]}getValue(b,c){return this.datalevel.getLayerValue(this.win.layer,
this.tileWindow,b|0,c|0)}getRowValues(b,c,d){c||(c=this.win.firstCol);d||(d=this.win.firstCol+this.win.numCols-c);return this.datalevel.getRowValues(this.tileWindow,b,c,d)}allTilesAvailable(){return this.tileWindow.allTilesAvailable()}onready(b){const c=this.tileWindow.onready();if(b)c.then(()=>b(this));else return c.then(()=>this)}isTileInWindow(b){return this.tileWindow.isTileInWindow(b)}}{var N=function(a){return"color_plot"==a.bar_type?{color_map:a.color_map}:{bg_color:a.bg_color,fg_color:a.fg_color,
low_bound:a.low_bound,high_bound:a.high_bound}};e.prototype.setCurrentDL=function(a){this._currentDl!=a&&(this._currentDl=a,this.setSelectionColors())};e.prototype.getCurrentDL=function(a){return this._currentDl};e.prototype.getCurrentColorMap=function(){return this.getColorMapManager().getColorMap("data",this.getCurrentDL())};e.prototype.setSelectionColors=function(){var a=this.getColorMapManager().getColorMap("data",this._currentDl);const b=this.getDataLayers()[this._currentDl];var c=u.hexToRgba(b.selection_color);
a=a.isColorDark(c)?"#000000":"#FFFFFF";c=document.documentElement;c.style.setProperty("--in-selection-color",a);c.style.setProperty("--in-selection-background-color",b.selection_color)};e.prototype.getMapConfig=function(){return this.mapConfig};e.prototype.isMapLoaded=function(){return null!==this.mapConfig};e.prototype.isFileMode=function(){return this.source()===g.FILE_SOURCE};e.prototype.isReadOnly=function(){return"Y"===this.mapConfig.data_configuration.map_information.read_only};e.prototype.getAxisConfig=
function(a){return n(a)?this.getRowConfig():this.getColConfig()};e.prototype.getRowConfig=function(){return this.mapConfig.row_configuration};e.prototype.getColConfig=function(){return this.mapConfig.col_configuration};e.prototype.getAxisCovariateConfig=function(a){return this.getAxisConfig(a).classifications};e.prototype.getAxisCovariateOrder=function(a){return n(a)?this.getRowClassificationOrder():this.getColClassificationOrder()};e.prototype.getRowClassificationConfig=function(){return this.mapConfig.row_configuration.classifications};
e.prototype.getRowClassificationConfigOrder=function(){return this.mapConfig.row_configuration.classifications_order};e.prototype.getColClassificationConfig=function(){return this.mapConfig.col_configuration.classifications};e.prototype.getColClassificationConfigOrder=function(){return this.mapConfig.col_configuration.classifications_order};e.prototype.getCovariateBarTypes=function(a){return Object.entries(this.getAxisCovariateConfig(a)).map(([,a])=>"Y"===a.show?a.bar_type:0)};e.prototype.getCovariateBarParams=
function(a){return Object.entries(this.getAxisCovariateConfig(a)).map(([,a])=>"Y"===a.show?N(a):{})};e.prototype.getRowClassificationOrder=function(a){var b=this.mapConfig.row_configuration.classifications_order;if("undefined"===typeof b)for(key in b=[],this.mapConfig.row_configuration.classifications)b.push(key);if("undefined"===typeof a)return b;{const f=[];for(a=0;a<b.length;a++){var c=b[a];"Y"==this.mapConfig.row_configuration.classifications[c].show&&f.push(c)}return f}};e.prototype.setRowClassificationOrder=
function(){null!==this.mapConfig&&(this.mapConfig.row_configuration.classifications_order=this.getRowClassificationOrder())};e.prototype.getColClassificationOrder=function(a){var b=this.mapConfig.col_configuration.classifications_order;if("undefined"===typeof b)for(key in b=[],this.mapConfig.col_configuration.classifications)b.push(key);if("undefined"===typeof a)return b;{const f=[];for(a=0;a<b.length;a++){var c=b[a];"Y"==this.mapConfig.col_configuration.classifications[c].show&&f.push(c)}return f}};
const b={r:0,g:0,b:0,a:0},c=u.hexToRgba("#FFFFFF");class d{constructor(a,b,c,d){Object.assign(this,c,{idx:b,label:a,height:c.height*d|0})}getScatterBarPlotColors(){const a=u.hexToRgba(this.fg_color);return["#FFFFFF"===this.subBgColor?b:u.hexToRgba(this.bg_color),a,c]}}e.prototype.getScaledVisibleCovariates=function(a,b){const c=n(a)?this.mapConfig.row_configuration:this.mapConfig.col_configuration;a=(c.hasOwnProperty("classifications_order")?c.classifications_order:Object.keys(c.classifications)).map((a,
f)=>new d(a,f,c.classifications[a],b)).filter(a=>"Y"===a.show);Object.defineProperty(a,"totalHeight",{value:function(){return this.map(a=>a.height).reduce((a,b)=>a+b,0)},enumerable:!1});Object.defineProperty(a,"containsLegend",{value:function(){return 0<this.filter(a=>"color_plot"!==a.bar_type).length},enumerable:!1});return a};e.prototype.hasHiddenCovariates=function(a){const b=n(a)?this.mapConfig.row_configuration:this.mapConfig.col_configuration;return 0<(b.hasOwnProperty("classifications_order")?
b.classifications_order:Object.keys(b.classifications)).map(a=>b.classifications[a].show).filter(a=>"Y"!==a).length};e.prototype.setColClassificationOrder=function(){null!==this.mapConfig&&(this.mapConfig.col_configuration.classifications_order=this.getColClassificationOrder())};e.prototype.getMapInformation=function(){return this.mapConfig.data_configuration.map_information};e.prototype.getDataLayers=function(){return this.mapConfig.data_configuration.map_information.data_layer};e.prototype.getCurrentDataLayer=
function(){return this.getDataLayers()[this.getCurrentDL()]};e.prototype.getDividerPref=function(){return this.mapConfig.data_configuration.map_information.summary_width};e.prototype.setDividerPref=function(a){if(void 0===a){a=document.getElementById("ngChmContainer");var b=document.getElementById("summary_chm");a=Math.ceil(100*b.clientWidth/a.clientWidth)}this.mapConfig.data_configuration.map_information.summary_width=a;this.mapConfig.data_configuration.map_information.detail_width=100-a};e.prototype.setClassificationPrefs=
function(a,b,c,d){n(b)?(this.mapConfig.row_configuration.classifications[a].show=c?"Y":"N",this.mapConfig.row_configuration.classifications[a].height=parseInt(d)):(this.mapConfig.col_configuration.classifications[a].show=c?"Y":"N",this.mapConfig.col_configuration.classifications[a].height=parseInt(d))};e.prototype.setClassBarScatterPrefs=function(a,b,c,d,e,g,k){n(b)?(this.mapConfig.row_configuration.classifications[a].bar_type=c,"undefined"!==typeof d&&(this.mapConfig.row_configuration.classifications[a].low_bound=
d,this.mapConfig.row_configuration.classifications[a].high_bound=e,this.mapConfig.row_configuration.classifications[a].fg_color=g,this.mapConfig.row_configuration.classifications[a].bg_color=k)):(this.mapConfig.col_configuration.classifications[a].bar_type=c,"undefined"!==typeof d&&(this.mapConfig.col_configuration.classifications[a].low_bound=d,this.mapConfig.col_configuration.classifications[a].high_bound=e,this.mapConfig.col_configuration.classifications[a].fg_color=g,this.mapConfig.col_configuration.classifications[a].bg_color=
k))};e.prototype.setLayerGridPrefs=function(a,b,c,d,e){this.mapConfig.data_configuration.map_information.data_layer[a].grid_show=b?"Y":"N";this.mapConfig.data_configuration.map_information.data_layer[a].grid_color=c;this.mapConfig.data_configuration.map_information.data_layer[a].cuts_color=e;this.mapConfig.data_configuration.map_information.data_layer[a].selection_color=d;a==this.getCurrentDL()&&this.setSelectionColors()};e.prototype.getRowOrganization=function(){return this.mapConfig.row_configuration.organization};
e.prototype.getColOrganization=function(){return this.mapConfig.col_configuration.organization};e.prototype.getMapInformation=function(){return this.mapConfig.data_configuration.map_information};e.prototype.getPanelConfiguration=function(){return this.mapConfig.panel_configuration};e.prototype.getRowDendroConfig=function(){return this.mapConfig.row_configuration.dendrogram};e.prototype.getColDendroConfig=function(){return this.mapConfig.col_configuration.dendrogram};e.prototype.setRowDendrogramShow=
function(a){this.mapConfig.row_configuration.dendrogram.show=a};e.prototype.setColDendrogramShow=function(a){this.mapConfig.col_configuration.dendrogram.show=a};e.prototype.setRowDendrogramHeight=function(a){this.mapConfig.row_configuration.dendrogram.height=a};e.prototype.setColDendrogramHeight=function(a){this.mapConfig.col_configuration.dendrogram.col_dendro_height=a};e.prototype.showRowDendrogram=function(a){var b=!0,c=this.mapConfig.row_configuration.dendrogram.show;if("NONE"===c||"NA"===c)b=
!1;"DETAIL"===a&&"SUMMARY"===c&&(b=!1);return b};e.prototype.showColDendrogram=function(a){var b=!0,c=this.mapConfig.col_configuration.dendrogram.show;if("NONE"===c||"NA"===c)b=!1;"DETAIL"===a&&"SUMMARY"===c&&(b=!1);return b};e.prototype.setReadOnly=function(){this.mapConfig.data_configuration.map_information.read_only="Y"};e.prototype.saveDataSentToPluginToMapConfig=function(a,b,c){try{var f=document.querySelectorAll('[data-nonce="'+a+'"]')[0].parentElement.parentElement}catch(z){throw"Cannot determine pane for given nonce";
}a=f.id;this.mapConfig.hasOwnProperty("panel_configuration")||(this.mapConfig.panel_configuration={});this.mapConfig.panel_configuration.hasOwnProperty(a)&&null!=this.mapConfig.panel_configuration[a]||(this.mapConfig.panel_configuration[a]={});b&&(this.mapConfig.panel_configuration[a].config=b);c&&(this.mapConfig.panel_configuration[a].data=c);this.mapConfig.panel_configuration[a].type="plugin";this.mapConfig.panel_configuration[a].pluginName=f.dataset.pluginName};e.prototype.removePaneInfoFromMapConfig=
function(a){this.mapConfig.hasOwnProperty("panel_configuration")&&(this.mapConfig.panel_configuration[a]=null)};e.prototype.saveLinkoutPaneToMapConfig=function(a,b,c){this.mapConfig.hasOwnProperty("panel_configuration")||(this.mapConfig.panel_configuration={});this.mapConfig.panel_configuration[a]={type:"linkout",url:b,paneTitle:c}};e.prototype.saveDataFromPluginToMapConfig=function(a,b){try{var c=document.querySelectorAll('[data-nonce="'+a+'"]')[0].parentElement.parentElement.id}catch(h){throw"Cannot determine pane for given nonce";
}this.mapConfig.hasOwnProperty("panel_configuration")||(this.mapConfig.panel_configuration={});this.mapConfig.panel_configuration.hasOwnProperty(c)&&null!=this.mapConfig.panel_configuration[c]||(this.mapConfig.panel_configuration[c]={});this.mapConfig.panel_configuration[c].dataFromPlugin=b};e.prototype.getAxisCovariateData=function(a){return n(a)?this.mapData.row_data.classifications:this.mapData.col_data.classifications};e.prototype.getRowClassificationData=function(){return this.mapData.row_data.classifications};
e.prototype.getColClassificationData=function(){return this.mapData.col_data.classifications};e.prototype.getAxisLabels=function(a){return n(a)?this.mapData.row_data.label:this.mapData.col_data.label};e.prototype.getRowLabels=function(){return this.mapData.row_data.label};e.prototype.getColLabels=function(){return this.mapData.col_data.label};e.prototype.getDendrogramData=function(a){return((n(a)?this.mapData.row_data.dendrogram:this.mapData.col_data.dendrogram)||[]).map(a=>{a=a.split(",");return{left:Number(a[0]),
right:Number(a[1]),height:Number(a[2])}})};e.prototype.getTotalRows=function(){return this.datalevels[k.DETAIL_LEVEL].totalRows};e.prototype.getSummaryRowRatio=function(){return null!==this.datalevels[k.SUMMARY_LEVEL]?this.datalevels[k.SUMMARY_LEVEL].rowSummaryRatio:this.datalevels[k.THUMBNAIL_LEVEL].rowSummaryRatio};e.prototype.getSummaryColRatio=function(){return null!==this.datalevels[k.SUMMARY_LEVEL]?this.datalevels[k.SUMMARY_LEVEL].colSummaryRatio:this.datalevels[k.THUMBNAIL_LEVEL].col_summaryRatio};
e.prototype.getTotalRows=function(){return this.datalevels[k.DETAIL_LEVEL].totalRows};e.prototype.getTotalCols=function(){return this.datalevels[k.DETAIL_LEVEL].totalColumns};e.prototype.getTotalElementsForAxis=function(a){const b=this.datalevels[k.DETAIL_LEVEL];return n(a)?b.totalRows:b.totalColumns};e.prototype.getNumRows=function(a){return this.datalevels[a].totalRows};e.prototype.getNumColumns=function(a){return this.datalevels[a].totalColumns};e.prototype.getRowSummaryRatio=function(a){return this.datalevels[a].rowSummaryRatio};
e.prototype.getColSummaryRatio=function(a){return this.datalevels[a].colSummaryRatio};e.prototype.getValue=function(a,b,c){return this.getNewAccessWindow({layer:this._currentDl,level:a,firstRow:b,firstCol:c,numRows:1,numCols:1}).getValue(b,c)};e.prototype.getAllAlternateLevels=function(a){function b(a){a=c.hasOwnProperty(a)?c[a]:[];const f=a.map(a=>b(a));return[...new Set(f.concat(a).flat())]}const c=this.alternateLevels;return b(a)};Object.assign(e.prototype,{initEventListeners:function(a){this.eventListeners=
a.slice(0)},addEventListener:function(a){this.eventListeners.push(a.bind(this))},sendAllListeners:function(a,b){this.eventListeners.forEach(c=>c(a,b));if(a===g.Event_NEWDATA){const {layer:c,level:f,row:d,col:e,data:g}=b,k=this.getAllAlternateLevels(f);for(;0<k.length;){const b={layer:c,level:k.shift(),row:d,col:e,data:g};this.eventListeners.forEach(c=>c(a,b))}}}});e.prototype.getColorMapManager=function(){if(null==this.mapConfig)return null;null==this.colorMapMgr&&(this.colorMapMgr=new u.ColorMapManager(this));
return this.colorMapMgr};e.prototype.initTileWindows=function(){this.tileWindowListeners=[];this.tileWindowRefs=new Map};e.prototype.updateTileWindows=function(a){this.tileWindowRefs.forEach((b,c)=>{(b=b.deref())?b.checkTile(a):this.tileWindowRefs.delete(c)});let b=0;for(;b<this.tileWindowListeners.length;){const c=this.tileWindowListeners[b];c.checkReady(c.tileWindow,a)?this.tileWindowListeners.splice(b,1):b++}this.sendCallBack(g.Event_NEWDATA,a)};e.prototype.tileIdReferenced=function(a){const [b,
c,d,e]=a.split(".");var g=!1;this.tileWindowRefs.forEach((a,f)=>{const [l,h,k,p,m,z]=f.split(".");l==b&&h==c&&(d|0)>=(k|0)&&(d|0)<=(p|0)&&(e|0)>=(m|0)&&(e|0)<=(z|0)&&(g=!0)});return g};e.prototype.hasGaps=function(){return 0!=this.getMapInformation().map_cut_rows+this.getMapInformation().map_cut_cols};e.prototype.source=function(){return this.fileSrc};e.prototype.setUnAppliedChanges=function(a){this.unAppliedChanges=a};e.prototype.getUnAppliedChanges=function(){return this.unAppliedChanges};e.prototype.sendCallBack=
function(a,b){if(a===g.Event_INITIALIZED||a===g.Event_JSON||a===g.Event_NEWDATA&&b.level===k.THUMBNAIL_LEVEL){null!=this.mapData&&null!=this.mapConfig&&0<Object.keys(this.datalevels).length&&this.tileCache.haveTileData(this.getCurrentDL()+"."+k.THUMBNAIL_LEVEL+".1.1")&&!this.initialized&&(this.initialized=!0,this.source()!==g.LOCAL_SOURCE&&(document.title=this.getMapInformation().name),document.getElementById("mapName").innerHTML=this.getMapInformation().name,this.mapConfig.hasOwnProperty("panel_configuration")||
q.hideLoader(!0),this.sendAllListeners(g.Event_INITIALIZED));const a=this.tileCache.getTileCacheData(this.getCurrentDL()+"."+k.SUMMARY_LEVEL+".1.1");a&&this.sendAllListeners(g.Event_NEWDATA,{layer:this.getCurrentDL(),level:k.SUMMARY_LEVEL,row:1,col:1,data:a})}a===g.Event_NEWDATA&&this.initialized&&this.sendAllListeners(a,b)};e.prototype.getNewTileWindow=function(a){const b=[a.layer,a.level,a.startRowTile,a.endRowTile,a.startColTile,a.endColTile].join(".");if(this.tileWindowRefs.has(b)){const a=this.tileWindowRefs.get(b).deref();
if(a)return a}a=new L(this,a);this.tileWindowRefs.set(b,new WeakRef(a));return a};e.prototype.getTileWindow=function(a){return this.datalevels[a.level].getTileAccessWindow(a.layer,a.firstRow,a.firstCol,a.numRows,a.numCols,a=>this.getNewTileWindow(a))};e.prototype.getNewAccessWindow=function(a){return new M(this,a)};e.prototype.getSummaryHist=function(a,b,c){c-=b;const d=Array(11).join("0").split("").map(parseFloat),f=Array(10).join("0").split("").map(parseFloat);for(let a=0;a<f.length;a++)f[a]+=b+
c/(f.length-1)*a;b=v.getNumColumns(k.SUMMARY_LEVEL);const e=v.getNumRows(k.SUMMARY_LEVEL),g=this.getNewAccessWindow({layer:a,level:k.SUMMARY_LEVEL,firstRow:1,firstCol:1,numRows:e,numCols:b});return g.onready().then(a=>{a=0;for(var b=1;b<=e;b++)for(var {value:c}of g.getRowValues(b))if(isNaN(c)||c>=k.maxValues)a++;else if(c>k.minValues){for(var l=0;l<f.length&&c>=f[l];)l++;d[l]++}c=0;b=a;for(l=0;l<d.length;l++)d[l]>b&&(b=d[l]),c+=d[l];return{breaks:f,bins:d,binMax:b,total:c,nan:a}})}}class I{constructor(b,
c,d,a){this.tileCache=b;this.level=c;this.totalRows=d.total_rows;this.totalColumns=d.total_cols;this.numTileRows=d.tile_rows;this.numTileColumns=d.tile_cols;this.rowsPerTile=d.rows_per_tile;this.colsPerTile=d.cols_per_tile;this.rowSummaryRatio=d.row_summary_ratio;this.colSummaryRatio=d.col_summary_ratio;this.lowerLevel=a;this.rowToLower=null===a?null:this.totalRows/a.totalRows;this.colToLower=null===a?null:this.totalColumns/a.totalColumns;this.lastTileWindow=null;this.isLineACut=Array(this.totalRows);
this.colsInLastTile=this.totalColumns%this.colsPerTile;0==this.colsInLastTile&&(this.colsInLastTile=this.colsPerTile);this.rowsInLastTile=this.totalRows%this.rowsPerTile;0==this.rowsInLastTile&&(this.rowsInLastTile=this.rowsPerTile)}numRowsInTile(b){return b<this.numTileRows?this.rowsPerTile:this.rowsInLastTile}numColsInTile(b){return b<this.numTileColumns?this.colsPerTile:this.colsInLastTile}getLayerValue(b,c,d,a){const f=Math.floor((d-1)/this.rowsPerTile)+1,e=Math.floor((a-1)/this.colsPerTile)+
1;!c&&this.lastTileWindow&&this.lastTileWindow.layer==b&&f>=this.lastTileWindow.startRowTile&&f<=this.lastTileWindow.endRowTile&&e>=this.lastTileWindow.startColTile&&e<=this.lastTileWindow.endColTile?c=this.lastTileWindow:c||(this.lastTileWindow=c=this.tileCache.heatMap.getNewTileWindow({layer:b,level:this.level,startRowTile:f,endRowTile:this.numTileRows,startColTile:1,endColTile:this.numTileColumns}));return(c=c.getTileData(f,e))?(b=this.numColsInTile(e),c[(d-1)%this.rowsPerTile*b+(a-1)%this.colsPerTile]):
null!=this.lowerLevel?this.lowerLevel.getLayerValue(b,null,Math.floor((d-1)/this.rowToLower)+1,Math.floor((a-1)/this.colToLower)+1):0}getRowValues(b,c,d,a){const f=b.layer;c|=0;d|=0;const e=Math.floor((c-1)/this.rowsPerTile)+1,g=(c-1)%this.rowsPerTile,k={},m=this,n=this.lowerLevel,q=this.colsPerTile,r=((c-1)/this.rowToLower|0)+1,O=this.colToLower,B=1/this.colToLower;k[Symbol.iterator]=function*(){for(let k=0;k<a;){var c=((d+k-1)/q|0)+1,l=m.numColsInTile(c),h=b.getTileData(e,c);c=Math.min(c*q-d-k+
1,a-k);let p=k;if(h){l=g*l+(d+k-1)%q;for(let a=0;a<c;a++)yield{i:p,col:d+p,value:h[l+a]},p++}else if(n){h=((d+k-1)*B|0)+1;l=n.tileCache.heatMap.getNewAccessWindow({layer:f,level:n.level,firstRow:r,firstCol:h,numRows:1,numCols:((d+k+c-2)*B|0)+1-h+1}).getRowValues(r);h=0;for(let {i:a,value:b}of l)for(l=Math.min((a+1)*O|0,c);h<l;)yield{i:p,col:d+p,value:b},p++,h++;for(;h<c;)yield{i:h,col:d+p,value:0},h++}else for(h=0;h<c;h++)yield{i:p,col:d+p,value:0},p++;k+=c}};return k}getTileAccessWindow(b,c,d,a,
f,e){return e({layer:b,level:this.level,startRowTile:Math.floor((c-1)/this.rowsPerTile)+1,endRowTile:Math.ceil((c+a-1)/this.rowsPerTile),startColTile:Math.floor((d-1)/this.colsPerTile)+1,endColTile:Math.ceil((d+f-1)/this.colsPerTile)})}}(function(){var b,c,d;g.initAxisLabels=function(){b={};c={ROW:[],COLUMN:[]};d={ROW:{},COLUMN:{}}};g.initAxisLabels();g.getActualLabels=function(a){a=g.isRow(a)?"ROW":"COLUMN";if(!b.hasOwnProperty(a)){const c=g.getHeatMap().getAxisLabels(a).labels;b[a]=c.map(a=>void 0===
a?void 0:a.split("|")[0])}return b[a]};g.getShownLabels=function(a){a=g.isRow(a)?"ROW":"COLUMN";var b=g.getHeatMap().getAxisConfig(a);if(d[a].label_display_length!==b.label_display_length||d[a].label_display_method!==b.label_display_method)d[a].label_display_length=b.label_display_length,d[a].label_display_method=b.label_display_method,b=g.getActualLabels(a),c[a]=b.map(b=>void 0===b?"":g.getLabelText(b,a));return c[a]}})();g.getLabelText=function(b,c,d){const a=g.getHeatMap();var f=parseInt(a.getColConfig().label_display_length),
e=a.getColConfig().label_display_method;"ROW"===c.toUpperCase()&&(f=parseInt(a.getRowConfig().label_display_length),e=a.getRowConfig().label_display_method);"undefined"!==typeof d&&(f=16);b.length>f&&(b="END"===e?b.substr(0,f-3)+"...":"MIDDLE"===e?b.substr(0,f/2-1)+"..."+b.substr(b.length-(f/2-2),b.length):"..."+b.substr(b.length-(f-3),b.length));return b};g.zipAppDownload=function(){{const b=g.getHeatMap();"undefined"!==typeof NgChm.galaxy?window.open("/plugins/visualizations/mda_heatmap_viz/static/ngChmApp.zip"):
b&&b.source()!==g.FILE_SOURCE?x("GET",t.api+"ZipAppDownload",!1):x("GET",r.viewerAppUrl,!1)}};g.showDownloadViewerNotification=y;e.prototype.loadHeatMapTile=function(b){var c=b.tileCacheName;this.tileCache.getTileCacheData(c)||this.currentTileRequests.includes(c)||(c=this.pendingTileRequests.map(b=>b.tileCacheName).indexOf(c),0<=c&&this.pendingTileRequests.splice(c,1),this.pendingTileRequests.push(b),10<this.currentTileRequests.length||this.submitFirstPendingTileRequest())};e.prototype.tileRequestComplete=
function(b,c){const d=this.currentTileRequests.indexOf(b);0>d?console.error("Tile has disappeared from currentTileRequests",{tileCacheName:b,currentTileRequests:this.currentTileRequests}):(this.currentTileRequests.splice(d,1),this.submitFirstPendingTileRequest());c?this.tileCache.setTileCacheEntry(b,c):this.tileCache.resetTileCacheEntry(b)};e.prototype.submitFirstPendingTileRequest=function(){let b=0==this.pendingTileRequests.length?null:this.pendingTileRequests.pop();for(;b&&!this.tileIdReferenced(b.tileCacheName);)b=
0==this.pendingTileRequests.length?null:this.pendingTileRequests.pop();b&&(this.currentTileRequests.push(b.tileCacheName),this.source()==g.WEB_SOURCE||this.source()==g.LOCAL_SOURCE?g.webLoader.postMessage({op:"loadTile",job:b}):K(this,b))};g.zipSaveMapProperties=function(b,c,d){function a(a){function f(a){return a.getData(new zip.TextWriter).then(b=>g(a.filename,b))}function e(b){return b.getData(new zip.BlobWriter).then(c=>a.add(b.filename,new zip.BlobReader(c)))}function g(b,c){return a.add(b,new zip.TextReader(c))}
return new Promise((h,k)=>{function l(p){var n=(1+p)/(1+m.length);d&&(d(n)||k("Cancelled by user"));if(p==m.length)h(a);else{n=m[p];const a=b.zipFiles[n];(0<=n.indexOf("bin")||0<=n.indexOf("tile")?e(a):0<=n.indexOf("mapConfig")?g(a.filename,JSON.stringify(c||b.mapConfig)):f(a)).then(()=>l(p+1))}}const m=Object.keys(b.zipFiles);l(0)})}return(new Promise((a,b)=>{a(new zip.ZipWriter(new zip.BlobWriter))})).then(b=>a(b)).then(a=>a.close()).then(a=>{saveAs(a,b.mapName+".ngchm");return!0}).catch(a=>{if("Cancelled by user"!=
a){const b=m.newMessageBox("error-saving-ngchm");b.style.width="20em";m.setNewMessageBoxHeader(b,"Failed to save NG-CHM");m.getNewMessageTextBox(b).innerHTML="<P><B>The NG-CHM was not saved.</B></P><P>The following error details were recorded:</P><P><B>"+a+"</B></P>";m.setNewMessageBoxButton(b,"close",{type:"text",text:"Close",tooltip:"Closes this dialog",default:!0});m.displayNewMessageBox(b)}return!1})};g.webSaveMapProperties=function(b){const c=JSON.stringify(b.getMapConfig());var d="false",a=
new XMLHttpRequest;a.open("POST",t.api+"SaveMapProperties?map="+b.mapName,!1);a.setRequestHeader("Content-Type","application/json");a.onreadystatechange=function(){a.readyState==a.DONE&&(200!=a.status?(console.log("Failed in call to save propeties from server: "+a.status),d="false"):d=a.response)};a.send(c);return d};g.zipMapProperties=function(b,c){x("POST",t.api+"ZippedMap?map="+b.mapName,c);return!0};{var P=function(b){const c=w(b);if(!c.flickInitialized){var a=b.getDataLayers(),e=Object.keys(a).length;
if(1<e){var g=Array(e);e=Array(e);for(let b in a){const c=+b.substring(2,b.length);e[c-1]=b;let d=a[b].name;20<d.length&&(d=d.substring(0,17)+"...");g[c-1]='<option value="'+b+'">'+d+"</option>"}a=(a=b.getPanelConfiguration())&&a.flickInfo?a.flickInfo:{};g=A.enableFlicks(e,g.join(""),a);b.setCurrentDL(g)}else b.setCurrentDL("dl1"),A.disableFlicks();c.flickInitialized=!0}},w=function(b){let c=C.get(b);c||(c={mapUpdatedOnLoad:!1,flickInitialized:!1},C.set(b,c));return c},v=null,C=new WeakMap;const b=
{addMapConfig:function(b,d){r.CompatibilityManager(d)&&(w(b).mapUpdatedOnLoad=!0);b.mapConfig=d;H(b);P(b);b.sendCallBack(g.Event_JSON)},addMapData:function(b,d){b.mapData=d;r.mapDataCompatibility(b.mapData)&&(w(b).mapUpdatedOnLoad=!0);b.sendCallBack(g.Event_JSON)}};g.mapUpdatedOnLoad=function(b){return w(b).mapUpdatedOnLoad};g.createHeatMap=function(c,d,a,f){v=new e(d,a,c,f,b)};g.getHeatMap=function(){return v}}null!==g.embeddedMapName||""===q.mapId&&""===q.mapNameRef||g.createWebLoader(g.WEB_SOURCE);
document.getElementById("mapName").addEventListener("mouseover",b=>{const c=g.getHeatMap();m.hlp(b.target,"Map Name: "+(null!==c?c.getMapInformation().name:"Not yet available")+"<br><br>Description: "+(null!==c?c.getMapInformation().description:"N/A"),350)},{passive:!0})})();
'use strict';(function(){NgChm.markFile();const l=NgChm.createNS("NgChm.DDR");NgChm.importNS("NgChm.MAPREP");NgChm.importNS("NgChm.MMGR");l.maxDendroHeight=3E3;l.minDendroHeight=500;l.minDendroWidth=500;l.Dendrogram=function(a){this.bars=[];this.dendroCanvas=a;this.getDivWidth=function(){return this.dendroCanvas.clientWidth+2*("Row"===this.axis)};this.getDivHeight=function(){return this.dendroCanvas.clientHeight+2*("Column"===this.axis)};this.getConfigSize=function(){return this.dendroConfig.height/
l.minDendroHeight};this.checkDendroHit=function(b,c,e){function d(d,b,c,e,g){b<=h&&c<=a&&(d=b*b+c*c,d<f&&(f=d,k=this.getLocalBarIndex(e,g)))}const a=this.dendroViewHeight/20,h=this.dendroViewWidth/60;let f=1E10,k=-1;for(let e=0;e<this.bars.length;e++){const a=this.bars[e];let f=c<a.left?a.left-c:c>a.right?c-a.right:0,g=Math.abs(b-a.height);d.call(this,"b",f,g,-1,e);f=Math.abs(c-a.left);g=b<a.leftBot?a.leftBot-b:b>a.height?b-a.height:0;d.call(this,"l",f,g,this.dendroData[a.idx].left-1,e);f=Math.abs(c-
a.right);g=b<a.rightBot?a.rightBot-b:b>a.height?b-a.height:0;d.call(this,"r",f,g,this.dendroData[a.idx].right-1,e)}-1!==k&&e(k)};this.setCanvasSize=function(a,c){this.dendroCanvas.width=a;this.dendroCanvas.height=c};this.timeout=null;this.drawView=function(){null==this.timeout&&this.debouncedDraw&&setTimeout(()=>{this.debouncedDraw();this.timeout=null})}};l.ColumnDendrogram=function(){this.axis="Column";this.canvasEventPosn=function(a){return{w:event.offsetX/this.dendroCanvas.clientWidth,h:(this.dendroCanvas.clientHeight-
event.offsetY)/this.dendroCanvas.clientHeight}};this.drawPDF=function(a,b){function c(a){const b=d(a.left*h),c=d(a.right*h);var f=d(g-a.height*g);const n=d(a.leftBot*g);a=d(a.rightBot*g);0<=f&&f<g&&(e.moveTo(Math.max(0,b),f),e.lineTo(Math.min(h,c),f));f=Math.min(Math.max(0,f),g-1);0<=b&&b<h&&n<g&&(e.moveTo(b,f),e.lineTo(b,g-1-n));0<=c&&c<h&&a<g&&(e.moveTo(c,f),e.lineTo(c,g-1-a))}a.setDrawColor(0);const e=a.context2d;e.save();a.setLineCap("square");a.setLineJoin("square");const d=Math.floor,g=d(100*
b.height),h=d(100*b.width);e.translate(b.left,b.top);e.scale(.01,.01);a=this.getScaledView();b=a.filter(a=>1===a.thickness);0<b.length&&(e.beginPath(),e.lineWidth=0,b.forEach(c),e.stroke());a=a.filter(a=>2===a.thickness);0<a.length&&(e.beginPath(),e.lineWidth=100,a.forEach(c),e.stroke());e.restore()};this.debouncedDraw=function(){const a=Math.floor,b=this.dendroCanvas.getContext("2d"),c=this.dendroCanvas.height,e=this.dendroCanvas.width;b.fillStyle="black";b.imageSmoothingEnabled=!1;b.clearRect(0,
0,e,c);this.getScaledView().forEach(d=>{const g=a(d.left*e),h=a(d.right*e);var f=a(c-d.height*c);const k=a(d.leftBot*c),m=a(d.rightBot*c);if(f<c){const a=Math.max(0,g);b.fillRect(a,f,Math.min(e,h+1)-a,d.thickness)}f=Math.min(Math.floor(d.height*c),c);0<=g&&g<e&&k<c&&b.fillRect(g,c-f,d.thickness,f-k);0<=h&&h<e&&m<c&&b.fillRect(h,c-f,d.thickness,f-m)})}};l.RowDendrogram=function(){this.axis="Row";this.canvasEventPosn=function(a){return{w:event.offsetY/this.dendroCanvas.clientHeight,h:(this.dendroCanvas.clientWidth-
event.offsetX)/this.dendroCanvas.clientWidth}};this.drawPDF=function(a,b){function c(a){const b=e(a.left*g),c=e(a.right*g);var f=e(h-a.height*h);const k=e(a.leftBot*h);a=e(a.rightBot*h);0<=f&&f<h&&(d.moveTo(f,Math.max(0,b)),d.lineTo(f,Math.min(g,c)));f=Math.min(Math.max(0,f),h-1);0<=b&&b<g&&k<h&&(d.moveTo(f,b),d.lineTo(h-1-k,b));0<=c&&c<g&&a<h&&(d.moveTo(f,c),d.lineTo(h-1-a,c))}const e=Math.floor;a.setDrawColor(0);const d=a.context2d;d.save();a.setLineCap("square");a.setLineJoin("square");d.translate(b.left,
b.top);d.scale(.01,.01);const g=e(100*b.height),h=e(100*b.width);b=this.getScaledView();const f=b.filter(a=>1===a.thickness);0<f.length&&(d.beginPath(),a.setLineWidth(0),f.forEach(c),d.stroke());b=b.filter(a=>2===a.thickness);0<b.length&&(d.beginPath(),a.setLineWidth(100),b.forEach(c),d.stroke());d.restore()};this.debouncedDraw=function(){const a=Math.floor,b=this.dendroCanvas.getContext("2d"),c=this.dendroCanvas.width,e=this.dendroCanvas.height;b.fillStyle="black";b.imageSmoothingEnabled=!1;b.clearRect(0,
0,c,e);this.getScaledView().forEach(d=>{const g=a(d.left*e),h=a(d.right*e);var f=a(c-d.height*c);const k=a(d.leftBot*c),l=a(d.rightBot*c);f<c&&b.fillRect(f,Math.max(0,g),d.thickness,Math.min(e,h+1)-Math.max(0,g));f=Math.min(Math.floor(d.height*c),c);0<=g&&g<e&&k<c&&b.fillRect(c-f,g,f-k,d.thickness);0<=h&&h<e&&l<c&&b.fillRect(c-f,h,f-l,d.thickness)})}}})();
'use strict';(function(){function m(a){let d=b.getGapItems(a);if(!d){let e=l.getHeatMap().getAxisLabels(a).labels;d={};e.forEach((a,b)=>{""==a&&(d[b+1]=!0)});b.setGapItems(a,d)}return d}NgChm.markFile();const b=NgChm.createNS("NgChm.SRCHSTATE"),l=NgChm.importNS("NgChm.MMGR"),c={Row:{},Column:{},RowCovar:{},ColumnCovar:{}};var g=new WeakMap;const k={},h={};b.getSearchSaveState=function(){const a={};a.row=b.getAxisSearchResults("Row");a.col=b.getAxisSearchResults("Column");return a};b.getGapItems=function(a){return a in
h?h[a]:null};b.getDiscCovState=function(a){return k[a]};b.getCurrentSearchItem=function(a){return g.get(a)||{}};b.getAxisSearchResults=function(a){l.isRow(a)&&(a="Row");"column"==a&&(a="Column");return Object.keys(c[a]).map(a=>+a)};b.getSearchResults=function(a){return c[a]};b.labelIndexInSearch=function(a,d){return null!=d&&null!=a&&1==c[a][d]};b.getSearchLabelsByAxis=function(a,d){let e=[];const f=l.getHeatMap(),c="Row"==a?f.getRowLabels().labels:"Column"==a?f.getColLabels().labels:"ColumnCovar"==
a?Object.keys(f.getColClassificationConfig()):"RowCovar"==a?Object.keys(f.getRowClassificationConfig()):[f.getRowLabels().labels,f.getColLabels().labels];b.getAxisSearchResults(a).forEach(b=>{a.includes("Covar")?d==linkouts.VISIBLE_LABELS?e.push(c[b].split("|")[0]):d==linkouts.HIDDEN_LABELS?e.push(c[b].split("|")[1]):e.push(c[b]):d==linkouts.VISIBLE_LABELS?e.push(c[b-1].split("|")[0]):d==linkouts.HIDDEN_LABELS?e.push(c[b-1].split("|")[1]):e.push(c[b-1])});return e};b.clearAllSearchResults=function(){c.Row=
{};c.Column={};c.RowCovar={};c.ColumnCovar={};g=new WeakMap;k.Row="";k.Column="";for(let a in h)delete h[a]};b.setGapItems=function(a,d){h[a]=d};b.setDiscCovState=function(a,d){k[a]=d};b.clearAllCurrentSearchItems=function(){g=new WeakMap};b.setSearchItem=function(a,d,b){let c=g.get(a);c||(c={},g.set(a,c));c.axis=d;c.index=b};b.setAxisSearchResults=function(a,b,e){const d=c[a];for(a=m(a);b<=e;b++)a[b]||(d[b]=1)};b.setAxisSearchResultsVec=function(a,b){const d=c[a],f=m(a);b.forEach(a=>{f[a]||(d[a]=
1)})};b.clearSearchRange=function(a,b,e){for(b=+b;b<+e+1;b++)delete c[a][b]};b.clearAllAxisSearchItems=function(a){c[a]={}}})();
